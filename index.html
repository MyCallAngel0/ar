<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>

<style>
  .arjs-loader {
    height: 100%;
    width: 100%;
    position: absolute;
    top: 0;
    left: 0;
    background-color: rgba(0, 0, 0, 0.8);
    z-index: 9999;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .arjs-loader div {
    text-align: center;
    font-size: 1.25em;
    color: white;
  }
</style>

<body style="margin:0; overflow:hidden;">
  <div class="arjs-loader">
    <div>Loading, please wait...</div>
  </div>

  <a-scene
    vr-mode-ui="enabled: false;"
    renderer="logarithmicDepthBuffer: true;"
    embedded
    arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false;"
  >

    <!-- 1 — House -->
    <a-nft
      id="marker1"
      type="nft"
      url="https://raw.githubusercontent.com/MyCallAngel0/ar/master/nft/grass/grass"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
      <a-entity
        class="house"
        position="0 0 -150"
        scale="200 200 200"
        rotation="-90 0 0"
        gltf-model="./models/house_minecraft.glb"
      ></a-entity>

      <a-text
          class="house"
          value="After a long day of mining you go home. You were so tired you could just drop on the FLOOR as soon as you enter" 
          color="white" 
          width="300" 
          rotation="-90 0 0 "
          position="-150 0 -75"
        ></a-text>`
    </a-nft>

    <!-- 2 — Herobrine -->
    <a-nft
      id="marker2"
      type="nft"
      url="https://raw.githubusercontent.com/MyCallAngel0/ar/master/nft/cobble/cobble"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
      <a-entity
        class="herobrine"
        position="0 0 -100"
        scale="50 50 50"
        rotation="90 -180 0"
        gltf-model="./models/herobrine.gltf"
        visible="false"
      ></a-entity>

      <a-text
          id="herobrine_text"
          value="Inside your house stands Herobrine! Your instincts tell you to fight back. Something unfortunate happened. Your game crashed. When you tried to enter back in the game, the LOGO was in black and white" 
          color="white" 
          width="250" 
          rotation="-90 0 0 "
          position="-125 0 -50"
          visible="false"
        ></a-text>`
    </a-nft>

    <!-- 3 - Zombie -->
    <a-nft
      id="marker3"
      type="nft"
      url="https://raw.githubusercontent.com/MyCallAngel0/ar/master/nft/meinkraft/meinkraft"
      smooth="true"
      smoothCount="10"
      smoothTolerance=".01"
      smoothThreshold="5"
    >
      <a-entity
        class="zombie"
        position="0 0 -100"
        scale="40 40 40"
        rotation="90 -180 0"
        gltf-model="./models/zombie.gltf"
        visible="false"
      ></a-entity>

      <a-text
          id="zombie_text"
          value="After entering your world you saw yourself as a zombie. You lost the battle against Herobrine and he made you a zombie. Now you have to search for other players to infect. The end!" 
          color="red" 
          width="200" 
          rotation="-90 0 0 "
          position="-100 0 -75"
          visible="false"
        ></a-text>`
    </a-nft>

    <a-entity camera>
      <a-text
        id="start" 
        value="Scan a the grass to start the story..."
        position="-1 0 -2"
        color="yellow"
        width="5"
        scale="0.5 0.5 0.5"
      ></a-text>
    </a-entity>
  </a-scene>

  <script>
    let scanned1 = false;
    let scanned2 = false;

    document.querySelector("#marker1").addEventListener("markerFound", () => {
      scanned1 = true;
      document.querySelector(".house").setAttribute("visible", true);
      document.querySelector("#start").setAttribute("visible", false);
    });

    document.querySelector("#marker2").addEventListener("markerFound", () => {
      if (scanned1) {
        scanned2 = true;
        document.querySelector(".herobrine").setAttribute("visible", true);
        document.querySelector("#herobrine_text").setAttribute("visible", true);
      }
    });

    document.querySelector("#marker3").addEventListener("markerFound", () => {
      if (scanned2) {
        document.querySelector(".zombie").setAttribute("visible", true);
        document.querySelector("#zombie_text").setAttribute("visible", true);
      }
    });
    
  </script>
